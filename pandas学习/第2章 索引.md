
# 第2章 索引


```python
import numpy as np
import pandas as pd
df = pd.read_csv('data/table.csv',index_col='ID')
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



## 一、单级索引
### 1. loc方法、iloc方法、[]操作符
#### 最常用的索引方法可能就是这三类，其中iloc表示位置索引，loc表示标签索引，[]也具有很大的便利性，各有特点
#### （a）loc方法（注意：所有在loc中使用的切片全部包含右端点！）
#### ① 单行索引：


```python
df.loc[1103]
```




    School          S_1
    Class           C_1
    Gender            M
    Address    street_2
    Height          186
    Weight           82
    Math           87.2
    Physics          B+
    Name: 1103, dtype: object



#### ② 多行索引：


```python
df.loc[[1102,2304]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2304</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_6</td>
      <td>164</td>
      <td>81</td>
      <td>95.5</td>
      <td>A-</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[1304:].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1304</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_2</td>
      <td>195</td>
      <td>70</td>
      <td>85.2</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1305</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_5</td>
      <td>187</td>
      <td>69</td>
      <td>61.7</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>2101</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_7</td>
      <td>174</td>
      <td>84</td>
      <td>83.3</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2102</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_6</td>
      <td>161</td>
      <td>61</td>
      <td>50.6</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2103</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_4</td>
      <td>157</td>
      <td>61</td>
      <td>52.5</td>
      <td>B-</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[2402::-1].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2402</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>M</td>
      <td>street_7</td>
      <td>166</td>
      <td>82</td>
      <td>48.7</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2401</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>62</td>
      <td>45.3</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2305</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>187</td>
      <td>73</td>
      <td>48.9</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2304</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_6</td>
      <td>164</td>
      <td>81</td>
      <td>95.5</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>2303</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_7</td>
      <td>190</td>
      <td>99</td>
      <td>65.9</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>



#### ③ 单列索引：


```python
df.loc[:,'Height'].head()
```




    ID
    1101    173
    1102    192
    1103    186
    1104    167
    1105    159
    Name: Height, dtype: int64



#### ④ 多列索引：


```python
df.loc[:,['Height','Math']].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Height</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>173</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>192</td>
      <td>32.5</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>186</td>
      <td>87.2</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>167</td>
      <td>80.4</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>159</td>
      <td>84.8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[:,'Height':'Math'].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
    </tr>
  </tbody>
</table>
</div>



#### ⑤ 联合索引：


```python
df.loc[1102:2401:3,'Height':'Math'].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>160</td>
      <td>53</td>
      <td>58.8</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
    </tr>
    <tr>
      <th>1304</th>
      <td>195</td>
      <td>70</td>
      <td>85.2</td>
    </tr>
  </tbody>
</table>
</div>



#### ⑥ 函数式索引：


```python
df.loc[lambda x:x['Gender']=='M'].head()
#loc中使用的函数，传入参数就是前面的df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1201</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>188</td>
      <td>68</td>
      <td>97.0</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_6</td>
      <td>160</td>
      <td>53</td>
      <td>58.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
def f(x):
    return [1101,1103]
df.loc[f]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### ⑦ 布尔索引（将重点在第2节介绍）


```python
df.loc[df['Address'].isin(['street_7','street_4'])].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1202</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_4</td>
      <td>176</td>
      <td>94</td>
      <td>63.5</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1303</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_7</td>
      <td>188</td>
      <td>82</td>
      <td>49.7</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2101</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_7</td>
      <td>174</td>
      <td>84</td>
      <td>83.3</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[[True if i[-1]=='4' or i[-1]=='7' else False for i in df['Address'].values]].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1202</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_4</td>
      <td>176</td>
      <td>94</td>
      <td>63.5</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1303</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_7</td>
      <td>188</td>
      <td>82</td>
      <td>49.7</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2101</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_7</td>
      <td>174</td>
      <td>84</td>
      <td>83.3</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>



#### 小节：本质上说，loc中能传入的只有布尔列表和索引子集构成的列表，只要把握这个原则就很容易理解上面那些操作
#### （b）iloc方法（注意与loc不同，切片右端点不包含）
#### ① 单行索引：


```python
df.iloc[3]
```




    School          S_1
    Class           C_1
    Gender            F
    Address    street_2
    Height          167
    Weight           81
    Math           80.4
    Physics          B-
    Name: 1104, dtype: object



#### ② 多行索引：


```python
df.iloc[3:5]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### ③ 单列索引：


```python
df.iloc[:,3].head()
```




    ID
    1101    street_1
    1102    street_2
    1103    street_2
    1104    street_2
    1105    street_4
    Name: Address, dtype: object



#### ④ 多列索引：


```python
df.iloc[:,7::-2].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Physics</th>
      <th>Weight</th>
      <th>Address</th>
      <th>Class</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>A+</td>
      <td>63</td>
      <td>street_1</td>
      <td>C_1</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>B+</td>
      <td>73</td>
      <td>street_2</td>
      <td>C_1</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>B+</td>
      <td>82</td>
      <td>street_2</td>
      <td>C_1</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>B-</td>
      <td>81</td>
      <td>street_2</td>
      <td>C_1</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>B+</td>
      <td>64</td>
      <td>street_4</td>
      <td>C_1</td>
    </tr>
  </tbody>
</table>
</div>



#### ⑤ 混合索引：


```python
df.iloc[3::4,7::-2].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Physics</th>
      <th>Weight</th>
      <th>Address</th>
      <th>Class</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1104</th>
      <td>B-</td>
      <td>81</td>
      <td>street_2</td>
      <td>C_1</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>A+</td>
      <td>53</td>
      <td>street_6</td>
      <td>C_2</td>
    </tr>
    <tr>
      <th>1302</th>
      <td>A-</td>
      <td>57</td>
      <td>street_1</td>
      <td>C_3</td>
    </tr>
    <tr>
      <th>2101</th>
      <td>C</td>
      <td>84</td>
      <td>street_7</td>
      <td>C_1</td>
    </tr>
    <tr>
      <th>2105</th>
      <td>A</td>
      <td>81</td>
      <td>street_4</td>
      <td>C_1</td>
    </tr>
  </tbody>
</table>
</div>



#### ⑥ 函数式索引：


```python
df.iloc[lambda x:[3]].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
  </tbody>
</table>
</div>



#### 小节：由上所述，iloc中接收的参数只能为整数或整数列表，不能使用布尔索引
#### （c） []操作符
#### 如果不想陷入困境，请不要在行索引为浮点时使用[]操作符，因为在Series中的浮点[]并不是进行位置比较，而是值比较，非常特殊
#### （c.1）Series的[]操作
#### ① 单元素索引：


```python
s = pd.Series(df['Math'],index=df.index)
s[1101]
#使用的是索引标签
```




    34.0



#### ② 多行索引：


```python
s[0:4]
#使用的是绝对位置的整数切片，与元素无关，这里容易混淆
```




    ID
    1101    34.0
    1102    32.5
    1103    87.2
    1104    80.4
    Name: Math, dtype: float64



#### ③ 函数式索引：


```python
s[lambda x: x.index[16::-6]]
#注意使用lambda函数时，直接切片(如：s[lambda x: 16::-6])就报错，此时使用的不是绝对位置切片，而是元素切片，非常易错
```




    ID
    2102    50.6
    1301    31.5
    1105    84.8
    Name: Math, dtype: float64



#### ④ 布尔索引：


```python
s[s>80]
```




    ID
    1103    87.2
    1104    80.4
    1105    84.8
    1201    97.0
    1302    87.7
    1304    85.2
    2101    83.3
    2205    85.4
    2304    95.5
    Name: Math, dtype: float64



#### （c.2）DataFrame的[]操作
#### ① 单行索引：


```python
df[1:2]
#这里非常容易写成df['label']，会报错
#同Series使用了绝对位置切片
#如果想要获得某一个元素，可用如下get_loc方法：
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
row = df.index.get_loc(1102)
df[row:row+1]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### ② 多行索引：


```python
#用切片，如果是选取指定的某几行，推荐使用loc，否则很可能报错
df[3:5]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### ③ 单列索引：


```python
df['School'].head()
```




    ID
    1101    S_1
    1102    S_1
    1103    S_1
    1104    S_1
    1105    S_1
    Name: School, dtype: object



#### ④ 多列索引：


```python
df[['School','Math']].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>32.5</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>87.2</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>80.4</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>84.8</td>
    </tr>
  </tbody>
</table>
</div>



#### ⑤函数式索引：


```python
df[lambda x:['Math','Physics']].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### ⑥ 布尔索引：


```python
df[df['Gender']=='F'].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1202</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_4</td>
      <td>176</td>
      <td>94</td>
      <td>63.5</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_5</td>
      <td>162</td>
      <td>63</td>
      <td>33.8</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>



#### 小节：一般来说，[]操作符常用于列选择或布尔选择，尽量避免行的选择
### 2. 布尔索引
#### （a）布尔符号：'&','|','~'：分别代表和and，或or，取反not


```python
df[(df['Gender']=='F')&(df['Address']=='street_2')].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>2401</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>62</td>
      <td>45.3</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2404</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>F</td>
      <td>street_2</td>
      <td>160</td>
      <td>84</td>
      <td>67.7</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[(df['Math']>85)|(df['Address']=='street_7')].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1201</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>188</td>
      <td>68</td>
      <td>97.0</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>1302</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_1</td>
      <td>175</td>
      <td>57</td>
      <td>87.7</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>1303</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_7</td>
      <td>188</td>
      <td>82</td>
      <td>49.7</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1304</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_2</td>
      <td>195</td>
      <td>70</td>
      <td>85.2</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[~((df['Math']>75)|(df['Address']=='street_1'))].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1202</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_4</td>
      <td>176</td>
      <td>94</td>
      <td>63.5</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_6</td>
      <td>160</td>
      <td>53</td>
      <td>58.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_5</td>
      <td>162</td>
      <td>63</td>
      <td>33.8</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1205</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_6</td>
      <td>167</td>
      <td>63</td>
      <td>68.4</td>
      <td>B-</td>
    </tr>
  </tbody>
</table>
</div>



#### loc和[]中相应位置都能使用布尔列表选择：


```python
df.loc[df['Math']>60,(df[:8]['Address']=='street_6').values].head()
#如果不加values就会索引对齐发生错误，Pandas中的索引对齐是一个重要特征，很多时候非常使用
#但是若不加以留意，就会埋下隐患
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1103</th>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>B+</td>
    </tr>
    <tr>
      <th>1201</th>
      <td>A-</td>
    </tr>
    <tr>
      <th>1202</th>
      <td>B-</td>
    </tr>
  </tbody>
</table>
</div>



#### （b） isin方法


```python
df[df['Address'].isin(['street_1','street_4'])&df['Physics'].isin(['A','A+'])]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>2105</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_4</td>
      <td>170</td>
      <td>81</td>
      <td>34.2</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2203</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_4</td>
      <td>155</td>
      <td>91</td>
      <td>73.8</td>
      <td>A+</td>
    </tr>
  </tbody>
</table>
</div>




```python
#上面也可以用字典方式写：
df[df[['Address','Physics']].isin({'Address':['street_1','street_4'],'Physics':['A','A+']}).all(1)]
#all与&的思路是类似的，其中的1代表按照跨列方向判断是否全为True
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>2105</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_4</td>
      <td>170</td>
      <td>81</td>
      <td>34.2</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2203</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_4</td>
      <td>155</td>
      <td>91</td>
      <td>73.8</td>
      <td>A+</td>
    </tr>
  </tbody>
</table>
</div>



### 3. 快速标量索引
#### 当只需要取一个元素时，at和iat方法能够提供更快的实现：


```python
display(df.at[1101,'School'])
display(df.loc[1101,'School'])
display(df.iat[0,0])
display(df.iloc[0,0])
#可尝试去掉注释对比时间
#%timeit df.at[1101,'School']
#%timeit df.loc[1101,'School']
#%timeit df.iat[0,0]
#%timeit df.iloc[0,0]
```


    'S_1'



    'S_1'



    'S_1'



    'S_1'


### 4. 区间索引
#### 此处介绍并不是说只能在单级索引中使用区间索引，只是作为一种特殊类型的索引方式，在此处先行介绍
#### （a）利用interval_range方法


```python
pd.interval_range(start=0,end=5)
#closed参数可选'left''right''both''neither'，默认左开右闭
```




    IntervalIndex([(0, 1], (1, 2], (2, 3], (3, 4], (4, 5]],
                  closed='right',
                  dtype='interval[int64]')




```python
pd.interval_range(start=0,periods=8,freq=5)
#periods参数控制区间个数，freq控制步长
```




    IntervalIndex([(0, 5], (5, 10], (10, 15], (15, 20], (20, 25], (25, 30], (30, 35], (35, 40]],
                  closed='right',
                  dtype='interval[int64]')



#### （b）利用cut将数值列转为区间为元素的分类变量，例如统计数学成绩的区间情况：


```python
math_interval = pd.cut(df['Math'],bins=[0,40,60,80,100])
#注意，如果没有类型转换，此时并不是区间类型，而是category类型
math_interval.head()
```




    ID
    1101      (0, 40]
    1102      (0, 40]
    1103    (80, 100]
    1104    (80, 100]
    1105    (80, 100]
    Name: Math, dtype: category
    Categories (4, interval[int64]): [(0, 40] < (40, 60] < (60, 80] < (80, 100]]



#### （c）区间索引的选取


```python
df_i = df.join(math_interval,rsuffix='_interval')[['Math','Math_interval']]\
            .reset_index().set_index('Math_interval')
df_i.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>Math_interval</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(0, 40]</th>
      <td>1101</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>(0, 40]</th>
      <td>1102</td>
      <td>32.5</td>
    </tr>
    <tr>
      <th>(80, 100]</th>
      <td>1103</td>
      <td>87.2</td>
    </tr>
    <tr>
      <th>(80, 100]</th>
      <td>1104</td>
      <td>80.4</td>
    </tr>
    <tr>
      <th>(80, 100]</th>
      <td>1105</td>
      <td>84.8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_i.loc[65].head()
#包含该值就会被选中
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>Math_interval</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(60, 80]</th>
      <td>1202</td>
      <td>63.5</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>1205</td>
      <td>68.4</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>1305</td>
      <td>61.7</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>2104</td>
      <td>72.2</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>2202</td>
      <td>68.5</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_i.loc[[65,90]].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>Math_interval</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(60, 80]</th>
      <td>1202</td>
      <td>63.5</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>1205</td>
      <td>68.4</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>1305</td>
      <td>61.7</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>2104</td>
      <td>72.2</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>2202</td>
      <td>68.5</td>
    </tr>
  </tbody>
</table>
</div>



#### 如果想要选取某个区间，先要把分类变量转为区间变量，再使用overlap方法：


```python
#df_i.loc[pd.Interval(70,75)].head() 报错
df_i[df_i.index.astype('interval').overlaps(pd.Interval(70, 85))].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Math</th>
    </tr>
    <tr>
      <th>Math_interval</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(80, 100]</th>
      <td>1103</td>
      <td>87.2</td>
    </tr>
    <tr>
      <th>(80, 100]</th>
      <td>1104</td>
      <td>80.4</td>
    </tr>
    <tr>
      <th>(80, 100]</th>
      <td>1105</td>
      <td>84.8</td>
    </tr>
    <tr>
      <th>(80, 100]</th>
      <td>1201</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>(60, 80]</th>
      <td>1202</td>
      <td>63.5</td>
    </tr>
  </tbody>
</table>
</div>



## 二、多级索引
### 1. 创建多级索引
#### （a）通过from_tuple或from_arrays
#### ① 直接创建元组


```python
tuples = [('A','a'),('A','b'),('B','a'),('B','b')]
mul_index = pd.MultiIndex.from_tuples(tuples, names=('Upper', 'Lower'))
mul_index
```




    MultiIndex([('A', 'a'),
                ('A', 'b'),
                ('B', 'a'),
                ('B', 'b')],
               names=['Upper', 'Lower'])




```python
pd.DataFrame({'Score':['perfect','good','fair','bad']},index=mul_index)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Score</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>Lower</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">A</th>
      <th>a</th>
      <td>perfect</td>
    </tr>
    <tr>
      <th>b</th>
      <td>good</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>a</th>
      <td>fair</td>
    </tr>
    <tr>
      <th>b</th>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>



#### ② 利用zip创建元组


```python
L1 = list('AABB')
L2 = list('abab')
tuples = list(zip(L1,L2))
mul_index = pd.MultiIndex.from_tuples(tuples, names=('Upper', 'Lower'))
pd.DataFrame({'Score':['perfect','good','fair','bad']},index=mul_index)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Score</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>Lower</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">A</th>
      <th>a</th>
      <td>perfect</td>
    </tr>
    <tr>
      <th>b</th>
      <td>good</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>a</th>
      <td>fair</td>
    </tr>
    <tr>
      <th>b</th>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>



#### ③ 通过Array创建


```python
arrays = [['A','a'],['A','b'],['B','a'],['B','b']]
mul_index = pd.MultiIndex.from_tuples(arrays, names=('Upper', 'Lower'))
pd.DataFrame({'Score':['perfect','good','fair','bad']},index=mul_index)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Score</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>Lower</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">A</th>
      <th>a</th>
      <td>perfect</td>
    </tr>
    <tr>
      <th>b</th>
      <td>good</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>a</th>
      <td>fair</td>
    </tr>
    <tr>
      <th>b</th>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>




```python
mul_index
#由此看出内部自动转成元组
```




    MultiIndex([('A', 'a'),
                ('A', 'b'),
                ('B', 'a'),
                ('B', 'b')],
               names=['Upper', 'Lower'])



#### （b）通过from_product


```python
L1 = ['A','B']
L2 = ['a','b']
pd.MultiIndex.from_product([L1,L2],names=('Upper', 'Lower'))
#两两相乘
```




    MultiIndex([('A', 'a'),
                ('A', 'b'),
                ('B', 'a'),
                ('B', 'b')],
               names=['Upper', 'Lower'])



#### （c）指定df中的列创建（set_index方法）


```python
df_using_mul = df.set_index(['Class','Address'])
df_using_mul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">C_1</th>
      <th>street_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>F</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_1</td>
      <td>F</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



### 2. 多层索引切片


```python
df_using_mul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">C_1</th>
      <th>street_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>F</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_1</td>
      <td>F</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### （a）一般切片


```python
#df_using_mul.loc['C_2','street_5']
#当索引不排序时，单个索引会报出性能警告
#df_using_mul.index.is_lexsorted()
#该函数检查是否排序
df_using_mul.sort_index().loc['C_2','street_5']
#df_using_mul.sort_index().index.is_lexsorted()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">C_2</th>
      <th>street_5</th>
      <td>S_1</td>
      <td>M</td>
      <td>188</td>
      <td>68</td>
      <td>97.0</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>street_5</th>
      <td>S_1</td>
      <td>F</td>
      <td>162</td>
      <td>63</td>
      <td>33.8</td>
      <td>B</td>
    </tr>
    <tr>
      <th>street_5</th>
      <td>S_2</td>
      <td>M</td>
      <td>193</td>
      <td>100</td>
      <td>39.1</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
#df_using_mul.loc[('C_2','street_5'):] 报错
#当不排序时，不能使用多层切片
df_using_mul.sort_index().loc[('C_2','street_6'):('C_3','street_4')]
#注意此处由于使用了loc，因此仍然包含右端点
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">C_2</th>
      <th>street_6</th>
      <td>S_1</td>
      <td>M</td>
      <td>160</td>
      <td>53</td>
      <td>58.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>street_6</th>
      <td>S_1</td>
      <td>F</td>
      <td>167</td>
      <td>63</td>
      <td>68.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>194</td>
      <td>77</td>
      <td>68.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>183</td>
      <td>76</td>
      <td>85.4</td>
      <td>B</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">C_3</th>
      <th>street_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>175</td>
      <td>57</td>
      <td>87.7</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>M</td>
      <td>195</td>
      <td>70</td>
      <td>85.2</td>
      <td>A</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_1</td>
      <td>M</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_2</td>
      <td>F</td>
      <td>157</td>
      <td>78</td>
      <td>72.3</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_2</td>
      <td>M</td>
      <td>187</td>
      <td>73</td>
      <td>48.9</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_using_mul.sort_index().loc[('C_2','street_7'):'C_3'].head()
#非元组也是合法的，表示选中该层所有元素
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">C_2</th>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>194</td>
      <td>77</td>
      <td>68.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>183</td>
      <td>76</td>
      <td>85.4</td>
      <td>B</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">C_3</th>
      <th>street_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>175</td>
      <td>57</td>
      <td>87.7</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>M</td>
      <td>195</td>
      <td>70</td>
      <td>85.2</td>
      <td>A</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_1</td>
      <td>M</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### （b）第一类特殊情况：由元组构成列表


```python
df_using_mul.sort_index().loc[[('C_2','street_7'),('C_3','street_2')]]
#表示选出某几个元素，精确到最内层索引
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">C_2</th>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>194</td>
      <td>77</td>
      <td>68.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>183</td>
      <td>76</td>
      <td>85.4</td>
      <td>B</td>
    </tr>
    <tr>
      <th>C_3</th>
      <th>street_2</th>
      <td>S_1</td>
      <td>M</td>
      <td>195</td>
      <td>70</td>
      <td>85.2</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>



#### （c）第二类特殊情况：由列表构成元组


```python
df_using_mul.sort_index().loc[(['C_2','C_3'],['street_4','street_7']),:]
#选出第一层在‘C_2’和'C_3'中且第二层在'street_4'和'street_7'中的行
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">C_2</th>
      <th>street_4</th>
      <td>S_1</td>
      <td>F</td>
      <td>176</td>
      <td>94</td>
      <td>63.5</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_2</td>
      <td>M</td>
      <td>155</td>
      <td>91</td>
      <td>73.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>194</td>
      <td>77</td>
      <td>68.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>183</td>
      <td>76</td>
      <td>85.4</td>
      <td>B</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">C_3</th>
      <th>street_4</th>
      <td>S_1</td>
      <td>M</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_2</td>
      <td>F</td>
      <td>157</td>
      <td>78</td>
      <td>72.3</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_2</td>
      <td>M</td>
      <td>187</td>
      <td>73</td>
      <td>48.9</td>
      <td>B</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_1</td>
      <td>M</td>
      <td>188</td>
      <td>82</td>
      <td>49.7</td>
      <td>B</td>
    </tr>
    <tr>
      <th>street_7</th>
      <td>S_2</td>
      <td>F</td>
      <td>190</td>
      <td>99</td>
      <td>65.9</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>



### 3. 多层索引中的slice对象


```python
L1,L2 = ['A','B','C'],['a','b','c']
mul_index1 = pd.MultiIndex.from_product([L1,L2],names=('Upper', 'Lower'))
L3,L4 = ['D','E','F'],['d','e','f']
mul_index2 = pd.MultiIndex.from_product([L3,L4],names=('Big', 'Small'))
df_s = pd.DataFrame(np.random.rand(9,9),index=mul_index1,columns=mul_index2)
df_s
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Big</th>
      <th colspan="3" halign="left">D</th>
      <th colspan="3" halign="left">E</th>
      <th colspan="3" halign="left">F</th>
    </tr>
    <tr>
      <th></th>
      <th>Small</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>Lower</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">A</th>
      <th>a</th>
      <td>0.027987</td>
      <td>0.544184</td>
      <td>0.946581</td>
      <td>0.299815</td>
      <td>0.648772</td>
      <td>0.723006</td>
      <td>0.471669</td>
      <td>0.355035</td>
      <td>0.385150</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.298573</td>
      <td>0.931495</td>
      <td>0.277038</td>
      <td>0.587902</td>
      <td>0.813917</td>
      <td>0.180738</td>
      <td>0.272506</td>
      <td>0.962261</td>
      <td>0.023938</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.903860</td>
      <td>0.639278</td>
      <td>0.587467</td>
      <td>0.078632</td>
      <td>0.463783</td>
      <td>0.540963</td>
      <td>0.004732</td>
      <td>0.709716</td>
      <td>0.150844</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B</th>
      <th>a</th>
      <td>0.624346</td>
      <td>0.301800</td>
      <td>0.523003</td>
      <td>0.239881</td>
      <td>0.103034</td>
      <td>0.034966</td>
      <td>0.085259</td>
      <td>0.088383</td>
      <td>0.384270</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.181395</td>
      <td>0.906966</td>
      <td>0.735006</td>
      <td>0.135459</td>
      <td>0.068137</td>
      <td>0.036331</td>
      <td>0.251947</td>
      <td>0.249235</td>
      <td>0.199806</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.680882</td>
      <td>0.634780</td>
      <td>0.005487</td>
      <td>0.703332</td>
      <td>0.814223</td>
      <td>0.598497</td>
      <td>0.044725</td>
      <td>0.065717</td>
      <td>0.133383</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">C</th>
      <th>a</th>
      <td>0.200763</td>
      <td>0.292782</td>
      <td>0.508914</td>
      <td>0.338325</td>
      <td>0.029445</td>
      <td>0.738470</td>
      <td>0.457656</td>
      <td>0.201499</td>
      <td>0.962006</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.631725</td>
      <td>0.147800</td>
      <td>0.495960</td>
      <td>0.487726</td>
      <td>0.733920</td>
      <td>0.890821</td>
      <td>0.390084</td>
      <td>0.683254</td>
      <td>0.753163</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.876673</td>
      <td>0.744558</td>
      <td>0.318619</td>
      <td>0.272133</td>
      <td>0.684913</td>
      <td>0.051760</td>
      <td>0.278338</td>
      <td>0.130785</td>
      <td>0.374925</td>
    </tr>
  </tbody>
</table>
</div>




```python
idx=pd.IndexSlice
```

#### 索引Slice的使用非常灵活：


```python
df_s.loc[idx['B':,df_s['D']['d']>0.3],idx[df_s.sum()>4]]
#df_s.sum()默认为对列求和，因此返回一个长度为9的数值列表
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Big</th>
      <th colspan="3" halign="left">D</th>
      <th>E</th>
    </tr>
    <tr>
      <th></th>
      <th>Small</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>e</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>Lower</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>a</th>
      <td>0.624346</td>
      <td>0.301800</td>
      <td>0.523003</td>
      <td>0.103034</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.680882</td>
      <td>0.634780</td>
      <td>0.005487</td>
      <td>0.814223</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">C</th>
      <th>b</th>
      <td>0.631725</td>
      <td>0.147800</td>
      <td>0.495960</td>
      <td>0.733920</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.876673</td>
      <td>0.744558</td>
      <td>0.318619</td>
      <td>0.684913</td>
    </tr>
  </tbody>
</table>
</div>



### 4. 索引层的交换
#### （a）swaplevel方法（两层交换）


```python
df_using_mul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">C_1</th>
      <th>street_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>S_1</td>
      <td>F</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>S_1</td>
      <td>F</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_using_mul.swaplevel(i=1,j=0,axis=0).sort_index().head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Address</th>
      <th>Class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">street_1</th>
      <th>C_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>C_2</th>
      <td>S_2</td>
      <td>M</td>
      <td>175</td>
      <td>74</td>
      <td>47.2</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>C_3</th>
      <td>S_1</td>
      <td>F</td>
      <td>175</td>
      <td>57</td>
      <td>87.7</td>
      <td>A-</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">street_2</th>
      <th>C_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>C_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### （b）reorder_levels方法（多层交换）


```python
df_muls = df.set_index(['School','Class','Address'])
df_muls.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>School</th>
      <th>Class</th>
      <th>Address</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">S_1</th>
      <th rowspan="5" valign="top">C_1</th>
      <th>street_1</th>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>street_2</th>
      <td>F</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>street_4</th>
      <td>F</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_muls.reorder_levels([2,0,1],axis=0).sort_index().head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Address</th>
      <th>School</th>
      <th>Class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">street_1</th>
      <th rowspan="2" valign="top">S_1</th>
      <th>C_1</th>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>C_3</th>
      <td>F</td>
      <td>175</td>
      <td>57</td>
      <td>87.7</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>S_2</th>
      <th>C_2</th>
      <td>M</td>
      <td>175</td>
      <td>74</td>
      <td>47.2</td>
      <td>B-</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">street_2</th>
      <th rowspan="2" valign="top">S_1</th>
      <th>C_1</th>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>C_1</th>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
#如果索引有name，可以直接使用name
df_muls.reorder_levels(['Address','School','Class'],axis=0).sort_index().head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Address</th>
      <th>School</th>
      <th>Class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">street_1</th>
      <th rowspan="2" valign="top">S_1</th>
      <th>C_1</th>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>C_3</th>
      <td>F</td>
      <td>175</td>
      <td>57</td>
      <td>87.7</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>S_2</th>
      <th>C_2</th>
      <td>M</td>
      <td>175</td>
      <td>74</td>
      <td>47.2</td>
      <td>B-</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">street_2</th>
      <th rowspan="2" valign="top">S_1</th>
      <th>C_1</th>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>C_1</th>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



## 三、索引设定
### 1. index_col参数
#### index_col是read_csv中的一个参数，而不是某一个方法：


```python
pd.read_csv('data/table.csv',index_col=['Address','School']).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Class</th>
      <th>ID</th>
      <th>Gender</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Address</th>
      <th>School</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>street_1</th>
      <th>S_1</th>
      <td>C_1</td>
      <td>1101</td>
      <td>M</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">street_2</th>
      <th>S_1</th>
      <td>C_1</td>
      <td>1102</td>
      <td>F</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>S_1</th>
      <td>C_1</td>
      <td>1103</td>
      <td>M</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>S_1</th>
      <td>C_1</td>
      <td>1104</td>
      <td>F</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>street_4</th>
      <th>S_1</th>
      <td>C_1</td>
      <td>1105</td>
      <td>F</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



### 2. reindex和reindex_like
#### reindex是指重新索引，它的重要特性在于索引对齐，很多时候用于重新排序


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.reindex(index=[1101,1203,1206,2402])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173.0</td>
      <td>63.0</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_6</td>
      <td>160.0</td>
      <td>53.0</td>
      <td>58.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1206</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2402</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>M</td>
      <td>street_7</td>
      <td>166.0</td>
      <td>82.0</td>
      <td>48.7</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.reindex(columns=['Height','Gender','Average']).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Height</th>
      <th>Gender</th>
      <th>Average</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>173</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>192</td>
      <td>F</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>186</td>
      <td>M</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>167</td>
      <td>F</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>159</td>
      <td>F</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



#### 可以选择缺失值的填充方法：fill_value和method（bfill/ffill/nearest），其中method参数必须索引单调


```python
df.reindex(index=[1101,1203,1206,2402],method='bfill')
#bfill表示用所在索引1206的后一个有效行填充，ffill为前一个有效行，nearest是指最近的
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_6</td>
      <td>160</td>
      <td>53</td>
      <td>58.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1206</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2402</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>M</td>
      <td>street_7</td>
      <td>166</td>
      <td>82</td>
      <td>48.7</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.reindex(index=[1101,1203,1206,2402],method='nearest')
#数值上1205比1301更接近1206，因此用前者填充
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_6</td>
      <td>160</td>
      <td>53</td>
      <td>58.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1206</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_6</td>
      <td>167</td>
      <td>63</td>
      <td>68.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>2402</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>M</td>
      <td>street_7</td>
      <td>166</td>
      <td>82</td>
      <td>48.7</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>



#### reindex_like的作用为生成一个横纵索引完全与参数列表一致的DataFrame，数据使用被调用的表


```python
df_temp = pd.DataFrame({'Weight':np.zeros(5),
                        'Height':np.zeros(5),
                        'ID':[1101,1104,1103,1106,1102]}).set_index('ID')
df_temp.reindex_like(df[0:5][['Weight','Height']])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Weight</th>
      <th>Height</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



#### 如果df_temp单调还可以使用method参数：


```python
df_temp = pd.DataFrame({'Weight':range(5),
                        'Height':range(5),
                        'ID':[1101,1104,1103,1106,1102]}).set_index('ID').sort_index()
df_temp.reindex_like(df[0:5][['Weight','Height']],method='bfill')
#可以自行检验这里的1105的值是否是由bfill规则填充
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Weight</th>
      <th>Height</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



### 3. set_index和reset_index
#### 先介绍set_index：从字面意思看，就是将某些列作为索引

#### 使用表内列作为索引：


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.set_index('Class').head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>Class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>C_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>C_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>C_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>C_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### 利用append参数可以将当前索引维持不变


```python
df.set_index('Class',append=True).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th>Class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <th>C_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <th>C_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <th>C_1</th>
      <td>S_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <th>C_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <th>C_1</th>
      <td>S_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### 当使用与表长相同的列作为索引（需要先转化为Series，否则报错）：


```python
df.set_index(pd.Series(range(df.shape[0]))).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### 可以直接添加多级索引：


```python
df.set_index([pd.Series(range(df.shape[0])),pd.Series(np.ones(df.shape[0]))]).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>1.0</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1</th>
      <th>1.0</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2</th>
      <th>1.0</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>3</th>
      <th>1.0</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>4</th>
      <th>1.0</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### 下面介绍reset_index方法，它的主要功能是将索引重置
#### 默认状态直接恢复到自然数索引：


```python
df.reset_index().head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1101</td>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1102</td>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1103</td>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1104</td>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1105</td>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### 用level参数指定哪一层被reset，用col_level参数指定set到哪一层：


```python
L1,L2 = ['A','B','C'],['a','b','c']
mul_index1 = pd.MultiIndex.from_product([L1,L2],names=('Upper', 'Lower'))
L3,L4 = ['D','E','F'],['d','e','f']
mul_index2 = pd.MultiIndex.from_product([L3,L4],names=('Big', 'Small'))
df_temp = pd.DataFrame(np.random.rand(9,9),index=mul_index1,columns=mul_index2)
df_temp.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Big</th>
      <th colspan="3" halign="left">D</th>
      <th colspan="3" halign="left">E</th>
      <th colspan="3" halign="left">F</th>
    </tr>
    <tr>
      <th></th>
      <th>Small</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>Lower</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">A</th>
      <th>a</th>
      <td>0.785838</td>
      <td>0.857532</td>
      <td>0.976202</td>
      <td>0.615206</td>
      <td>0.423174</td>
      <td>0.899071</td>
      <td>0.375861</td>
      <td>0.519238</td>
      <td>0.710781</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.927155</td>
      <td>0.215835</td>
      <td>0.812371</td>
      <td>0.154263</td>
      <td>0.983221</td>
      <td>0.094316</td>
      <td>0.503254</td>
      <td>0.934906</td>
      <td>0.897017</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.506408</td>
      <td>0.269959</td>
      <td>0.752839</td>
      <td>0.514940</td>
      <td>0.670330</td>
      <td>0.035187</td>
      <td>0.797860</td>
      <td>0.031785</td>
      <td>0.096824</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>a</th>
      <td>0.571551</td>
      <td>0.356124</td>
      <td>0.940680</td>
      <td>0.444541</td>
      <td>0.035023</td>
      <td>0.999506</td>
      <td>0.230278</td>
      <td>0.314158</td>
      <td>0.599316</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.985954</td>
      <td>0.661002</td>
      <td>0.688183</td>
      <td>0.231542</td>
      <td>0.852335</td>
      <td>0.318169</td>
      <td>0.834608</td>
      <td>0.185266</td>
      <td>0.717008</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_temp1 = df_temp.reset_index(level=1,col_level=1)
df_temp1.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>Big</th>
      <th></th>
      <th colspan="3" halign="left">D</th>
      <th colspan="3" halign="left">E</th>
      <th colspan="3" halign="left">F</th>
    </tr>
    <tr>
      <th>Small</th>
      <th>Lower</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>a</td>
      <td>0.785838</td>
      <td>0.857532</td>
      <td>0.976202</td>
      <td>0.615206</td>
      <td>0.423174</td>
      <td>0.899071</td>
      <td>0.375861</td>
      <td>0.519238</td>
      <td>0.710781</td>
    </tr>
    <tr>
      <th>A</th>
      <td>b</td>
      <td>0.927155</td>
      <td>0.215835</td>
      <td>0.812371</td>
      <td>0.154263</td>
      <td>0.983221</td>
      <td>0.094316</td>
      <td>0.503254</td>
      <td>0.934906</td>
      <td>0.897017</td>
    </tr>
    <tr>
      <th>A</th>
      <td>c</td>
      <td>0.506408</td>
      <td>0.269959</td>
      <td>0.752839</td>
      <td>0.514940</td>
      <td>0.670330</td>
      <td>0.035187</td>
      <td>0.797860</td>
      <td>0.031785</td>
      <td>0.096824</td>
    </tr>
    <tr>
      <th>B</th>
      <td>a</td>
      <td>0.571551</td>
      <td>0.356124</td>
      <td>0.940680</td>
      <td>0.444541</td>
      <td>0.035023</td>
      <td>0.999506</td>
      <td>0.230278</td>
      <td>0.314158</td>
      <td>0.599316</td>
    </tr>
    <tr>
      <th>B</th>
      <td>b</td>
      <td>0.985954</td>
      <td>0.661002</td>
      <td>0.688183</td>
      <td>0.231542</td>
      <td>0.852335</td>
      <td>0.318169</td>
      <td>0.834608</td>
      <td>0.185266</td>
      <td>0.717008</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_temp1.columns
#看到的确插入了level2
```




    MultiIndex([( '', 'Lower'),
                ('D',     'd'),
                ('D',     'e'),
                ('D',     'f'),
                ('E',     'd'),
                ('E',     'e'),
                ('E',     'f'),
                ('F',     'd'),
                ('F',     'e'),
                ('F',     'f')],
               names=['Big', 'Small'])




```python
df_temp1.index
#最内层索引被移出
```




    Index(['A', 'A', 'A', 'B', 'B', 'B', 'C', 'C', 'C'], dtype='object', name='Upper')



### 4. rename_axis和rename
#### rename_axis是针对多级索引的方法，作用是修改某一层的索引名，而不是索引标签


```python
df_temp.rename_axis(index={'Lower':'LowerLower'},columns={'Big':'BigBig'})
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>BigBig</th>
      <th colspan="3" halign="left">D</th>
      <th colspan="3" halign="left">E</th>
      <th colspan="3" halign="left">F</th>
    </tr>
    <tr>
      <th></th>
      <th>Small</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>LowerLower</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">A</th>
      <th>a</th>
      <td>0.785838</td>
      <td>0.857532</td>
      <td>0.976202</td>
      <td>0.615206</td>
      <td>0.423174</td>
      <td>0.899071</td>
      <td>0.375861</td>
      <td>0.519238</td>
      <td>0.710781</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.927155</td>
      <td>0.215835</td>
      <td>0.812371</td>
      <td>0.154263</td>
      <td>0.983221</td>
      <td>0.094316</td>
      <td>0.503254</td>
      <td>0.934906</td>
      <td>0.897017</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.506408</td>
      <td>0.269959</td>
      <td>0.752839</td>
      <td>0.514940</td>
      <td>0.670330</td>
      <td>0.035187</td>
      <td>0.797860</td>
      <td>0.031785</td>
      <td>0.096824</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B</th>
      <th>a</th>
      <td>0.571551</td>
      <td>0.356124</td>
      <td>0.940680</td>
      <td>0.444541</td>
      <td>0.035023</td>
      <td>0.999506</td>
      <td>0.230278</td>
      <td>0.314158</td>
      <td>0.599316</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.985954</td>
      <td>0.661002</td>
      <td>0.688183</td>
      <td>0.231542</td>
      <td>0.852335</td>
      <td>0.318169</td>
      <td>0.834608</td>
      <td>0.185266</td>
      <td>0.717008</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.494502</td>
      <td>0.519868</td>
      <td>0.250968</td>
      <td>0.956638</td>
      <td>0.806268</td>
      <td>0.881676</td>
      <td>0.574490</td>
      <td>0.874363</td>
      <td>0.539547</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">C</th>
      <th>a</th>
      <td>0.959140</td>
      <td>0.961787</td>
      <td>0.463601</td>
      <td>0.352087</td>
      <td>0.640675</td>
      <td>0.437803</td>
      <td>0.733015</td>
      <td>0.575136</td>
      <td>0.356999</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.682645</td>
      <td>0.264561</td>
      <td>0.084952</td>
      <td>0.797615</td>
      <td>0.065370</td>
      <td>0.782668</td>
      <td>0.680838</td>
      <td>0.022767</td>
      <td>0.483909</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.052374</td>
      <td>0.554090</td>
      <td>0.263994</td>
      <td>0.750738</td>
      <td>0.911818</td>
      <td>0.606205</td>
      <td>0.090180</td>
      <td>0.499667</td>
      <td>0.199807</td>
    </tr>
  </tbody>
</table>
</div>



#### rename方法用于修改列或者行索引标签，而不是索引名：


```python
df_temp.rename(index={'A':'T'},columns={'e':'changed_e'}).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Big</th>
      <th colspan="3" halign="left">D</th>
      <th colspan="3" halign="left">E</th>
      <th colspan="3" halign="left">F</th>
    </tr>
    <tr>
      <th></th>
      <th>Small</th>
      <th>d</th>
      <th>changed_e</th>
      <th>f</th>
      <th>d</th>
      <th>changed_e</th>
      <th>f</th>
      <th>d</th>
      <th>changed_e</th>
      <th>f</th>
    </tr>
    <tr>
      <th>Upper</th>
      <th>Lower</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">T</th>
      <th>a</th>
      <td>0.785838</td>
      <td>0.857532</td>
      <td>0.976202</td>
      <td>0.615206</td>
      <td>0.423174</td>
      <td>0.899071</td>
      <td>0.375861</td>
      <td>0.519238</td>
      <td>0.710781</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.927155</td>
      <td>0.215835</td>
      <td>0.812371</td>
      <td>0.154263</td>
      <td>0.983221</td>
      <td>0.094316</td>
      <td>0.503254</td>
      <td>0.934906</td>
      <td>0.897017</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.506408</td>
      <td>0.269959</td>
      <td>0.752839</td>
      <td>0.514940</td>
      <td>0.670330</td>
      <td>0.035187</td>
      <td>0.797860</td>
      <td>0.031785</td>
      <td>0.096824</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>a</th>
      <td>0.571551</td>
      <td>0.356124</td>
      <td>0.940680</td>
      <td>0.444541</td>
      <td>0.035023</td>
      <td>0.999506</td>
      <td>0.230278</td>
      <td>0.314158</td>
      <td>0.599316</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.985954</td>
      <td>0.661002</td>
      <td>0.688183</td>
      <td>0.231542</td>
      <td>0.852335</td>
      <td>0.318169</td>
      <td>0.834608</td>
      <td>0.185266</td>
      <td>0.717008</td>
    </tr>
  </tbody>
</table>
</div>



## 四、常用索引型函数
### 1. where函数
#### 当对条件为False的单元进行填充：


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.where(df['Gender']=='M').head()
#不满足条件的行全部被设置为NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173.0</td>
      <td>63.0</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186.0</td>
      <td>82.0</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



#### 通过这种方法筛选结果和[]操作符的结果完全一致：


```python
df.where(df['Gender']=='M').dropna().head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173.0</td>
      <td>63.0</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186.0</td>
      <td>82.0</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1201</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>188.0</td>
      <td>68.0</td>
      <td>97.0</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_6</td>
      <td>160.0</td>
      <td>53.0</td>
      <td>58.8</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161.0</td>
      <td>68.0</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### 第一个参数为布尔条件，第二个参数为填充值：


```python
df.where(df['Gender']=='M',np.random.rand(df.shape[0],df.shape[1])).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173.000000</td>
      <td>63.000000</td>
      <td>34.000000</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>0.649741</td>
      <td>0.574143</td>
      <td>0.0287152</td>
      <td>0.52367</td>
      <td>0.495548</td>
      <td>0.102486</td>
      <td>0.389434</td>
      <td>0.284185</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186.000000</td>
      <td>82.000000</td>
      <td>87.200000</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>0.0434731</td>
      <td>0.0604484</td>
      <td>0.447919</td>
      <td>0.556049</td>
      <td>0.434849</td>
      <td>0.924584</td>
      <td>0.262874</td>
      <td>0.733613</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>0.293098</td>
      <td>0.395998</td>
      <td>0.118377</td>
      <td>0.550498</td>
      <td>0.426615</td>
      <td>0.623352</td>
      <td>0.052667</td>
      <td>0.388854</td>
    </tr>
  </tbody>
</table>
</div>



### 2. mask函数
#### mask函数与where功能上相反，其余完全一致，即对条件为True的单元进行填充


```python
df.mask(df['Gender']=='M').dropna().head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192.0</td>
      <td>73.0</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167.0</td>
      <td>81.0</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159.0</td>
      <td>64.0</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1202</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_4</td>
      <td>176.0</td>
      <td>94.0</td>
      <td>63.5</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_5</td>
      <td>162.0</td>
      <td>63.0</td>
      <td>33.8</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.mask(df['Gender']=='M',np.random.rand(df.shape[0],df.shape[1])).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>0.22032</td>
      <td>0.791295</td>
      <td>0.902822</td>
      <td>0.776696</td>
      <td>0.791582</td>
      <td>0.680499</td>
      <td>0.890786</td>
      <td>0.58187</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192.000000</td>
      <td>73.000000</td>
      <td>32.500000</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>0.135281</td>
      <td>0.52086</td>
      <td>0.551126</td>
      <td>0.107776</td>
      <td>0.040307</td>
      <td>0.576286</td>
      <td>0.897657</td>
      <td>0.390924</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167.000000</td>
      <td>81.000000</td>
      <td>80.400000</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159.000000</td>
      <td>64.000000</td>
      <td>84.800000</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



### 3. query函数


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_2</td>
      <td>186</td>
      <td>82</td>
      <td>87.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>167</td>
      <td>81</td>
      <td>80.4</td>
      <td>B-</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>



#### query函数中的布尔表达式中，下面的符号都是合法的：行列索引名、字符串、and/not/or/&/|/~/not in/in/==/!=、四则运算符


```python
df.query('(Address in ["street_6","street_7"])&(Weight>(70+10))&(ID in [1303,2304,2402])')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1303</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_7</td>
      <td>188</td>
      <td>82</td>
      <td>49.7</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2304</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_6</td>
      <td>164</td>
      <td>81</td>
      <td>95.5</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>2402</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>M</td>
      <td>street_7</td>
      <td>166</td>
      <td>82</td>
      <td>48.7</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>



## 五、重复元素处理
### 1. duplicated方法
#### 该方法返回了是否重复的布尔列表


```python
df.duplicated('Class').head()
```




    ID
    1101    False
    1102     True
    1103     True
    1104     True
    1105     True
    dtype: bool



#### 可选参数keep默认为first，即首次出现设为不重复，若为last，则最后一次设为不重复，若为False，则所有重复项为False


```python
df.duplicated('Class',keep='last').tail()
```




    ID
    2401     True
    2402     True
    2403     True
    2404     True
    2405    False
    dtype: bool




```python
df.duplicated('Class',keep=False).head()
```




    ID
    1101    True
    1102    True
    1103    True
    1104    True
    1105    True
    dtype: bool



### 2. drop_duplicates方法
#### 从名字上看出为剔除重复项，这在后面章节中的分组操作中可能是有用的，例如需要保留每组的第一个值：


```python
df.drop_duplicates('Class')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1201</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>188</td>
      <td>68</td>
      <td>97.0</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2401</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>62</td>
      <td>45.3</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>



#### 参数与duplicate函数类似：


```python
df.drop_duplicates('Class',keep='last')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2105</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_4</td>
      <td>170</td>
      <td>81</td>
      <td>34.2</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2205</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_7</td>
      <td>183</td>
      <td>76</td>
      <td>85.4</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2305</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>187</td>
      <td>73</td>
      <td>48.9</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2405</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>F</td>
      <td>street_6</td>
      <td>193</td>
      <td>54</td>
      <td>47.6</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>



#### 在传入多列时等价于将多列共同视作一个多级索引，比较重复项：


```python
df.drop_duplicates(['School','Class'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_1</td>
      <td>173</td>
      <td>63</td>
      <td>34.0</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1201</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>188</td>
      <td>68</td>
      <td>97.0</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2101</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_7</td>
      <td>174</td>
      <td>84</td>
      <td>83.3</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2201</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>193</td>
      <td>100</td>
      <td>39.1</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2301</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_4</td>
      <td>157</td>
      <td>78</td>
      <td>72.3</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2401</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>62</td>
      <td>45.3</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>



## 六、抽样函数
#### 这里的抽样函数指的就是sample函数
#### （a）n为样本量


```python
df.sample(n=5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2405</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>F</td>
      <td>street_6</td>
      <td>193</td>
      <td>54</td>
      <td>47.6</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_4</td>
      <td>159</td>
      <td>64</td>
      <td>84.8</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2402</th>
      <td>S_2</td>
      <td>C_4</td>
      <td>M</td>
      <td>street_7</td>
      <td>166</td>
      <td>82</td>
      <td>48.7</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2103</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_4</td>
      <td>157</td>
      <td>61</td>
      <td>52.5</td>
      <td>B-</td>
    </tr>
  </tbody>
</table>
</div>



#### （b）frac为抽样比


```python
df.sample(frac=0.05)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2205</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_7</td>
      <td>183</td>
      <td>76</td>
      <td>85.4</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2304</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_6</td>
      <td>164</td>
      <td>81</td>
      <td>95.5</td>
      <td>A-</td>
    </tr>
  </tbody>
</table>
</div>



#### （c）replace为是否放回


```python
df.sample(n=df.shape[0],replace=True).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2104</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_5</td>
      <td>159</td>
      <td>97</td>
      <td>72.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2305</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>187</td>
      <td>73</td>
      <td>48.9</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1301</th>
      <td>S_1</td>
      <td>C_3</td>
      <td>M</td>
      <td>street_4</td>
      <td>161</td>
      <td>68</td>
      <td>31.5</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>S_1</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_5</td>
      <td>162</td>
      <td>63</td>
      <td>33.8</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2201</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>193</td>
      <td>100</td>
      <td>39.1</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sample(n=35,replace=True).index.is_unique
```




    False



#### （d）axis为抽样维度，默认为0，即抽行


```python
df.sample(n=3,axis=1).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Math</th>
      <th>Weight</th>
      <th>School</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1101</th>
      <td>34.0</td>
      <td>63</td>
      <td>S_1</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>32.5</td>
      <td>73</td>
      <td>S_1</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>87.2</td>
      <td>82</td>
      <td>S_1</td>
    </tr>
    <tr>
      <th>1104</th>
      <td>80.4</td>
      <td>81</td>
      <td>S_1</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>84.8</td>
      <td>64</td>
      <td>S_1</td>
    </tr>
  </tbody>
</table>
</div>



#### （e）weights为样本权重，自动归一化


```python
df.sample(n=3,weights=np.random.rand(df.shape[0])).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2104</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_5</td>
      <td>159</td>
      <td>97</td>
      <td>72.2</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>2304</th>
      <td>S_2</td>
      <td>C_3</td>
      <td>F</td>
      <td>street_6</td>
      <td>164</td>
      <td>81</td>
      <td>95.5</td>
      <td>A-</td>
    </tr>
    <tr>
      <th>1102</th>
      <td>S_1</td>
      <td>C_1</td>
      <td>F</td>
      <td>street_2</td>
      <td>192</td>
      <td>73</td>
      <td>32.5</td>
      <td>B+</td>
    </tr>
  </tbody>
</table>
</div>




```python
#以某一列为权重，这在抽样理论中很常见
df.sample(n=3,weights=df['Math']).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
      <th>Class</th>
      <th>Gender</th>
      <th>Address</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Math</th>
      <th>Physics</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2201</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>M</td>
      <td>street_5</td>
      <td>193</td>
      <td>100</td>
      <td>39.1</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2101</th>
      <td>S_2</td>
      <td>C_1</td>
      <td>M</td>
      <td>street_7</td>
      <td>174</td>
      <td>84</td>
      <td>83.3</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2205</th>
      <td>S_2</td>
      <td>C_2</td>
      <td>F</td>
      <td>street_7</td>
      <td>183</td>
      <td>76</td>
      <td>85.4</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>



## 七、问题与练习

### 1. 问题
#### 【问题一】 如何更改列或行的顺序？如何交换奇偶行（列）的顺序？


#### 【问题二】 如果要选出DataFrame的某个子集，请给出尽可能多的方法实现。



#### 【问题三】 query函数比其他索引方法的速度更慢吗？在什么场合使用什么索引最高效？



#### 【问题四】 单级索引能使用Slice对象吗？能的话怎么使用，请给出一个例子。


#### 【问题五】 如何快速找出某一列的缺失值所在索引？


#### 【问题六】 索引设定中的所有方法分别适用于哪些场合？怎么直接把某个DataFrame的索引换成任意给定同长度的索引？



#### 【问题七】 多级索引有什么适用场合？


#### 【问题八】 什么时候需要重复元素处理？



### 2. 练习
#### 【练习一】 现有一份关于UFO的数据集，请解决下列问题：


```python
pd.read_csv('data/UFO.csv').head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>shape</th>
      <th>duration (seconds)</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10/10/1949 20:30</td>
      <td>cylinder</td>
      <td>2700.0</td>
      <td>29.883056</td>
      <td>-97.941111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10/10/1949 21:00</td>
      <td>light</td>
      <td>7200.0</td>
      <td>29.384210</td>
      <td>-98.581082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10/10/1955 17:00</td>
      <td>circle</td>
      <td>20.0</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10/10/1956 21:00</td>
      <td>circle</td>
      <td>20.0</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10/10/1960 20:00</td>
      <td>light</td>
      <td>900.0</td>
      <td>21.418056</td>
      <td>-157.803611</td>
    </tr>
  </tbody>
</table>
</div>



#### （a）在所有被观测时间超过60s的时间中，哪个形状最多？
#### （b）对经纬度进行划分：-180°至180°以30°为一个划分，-90°至90°以18°为一个划分，请问哪个区域中报告的UFO事件数量最多？


```python
# （a）在所有被观测时间超过60s的时间中，哪个形状最多？
df = pd.read_csv('data/UFO.csv').head()
```

#### 【练习二】 现有一份关于口袋妖怪的数据集，请解决下列问题：


```python
pd.read_csv('data/Pokemon.csv').head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#</th>
      <th>Name</th>
      <th>Type 1</th>
      <th>Type 2</th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Generation</th>
      <th>Legendary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Bulbasaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Ivysaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Venusaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>VenusaurMega Venusaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Charmander</td>
      <td>Fire</td>
      <td>NaN</td>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>1</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>



#### （a）双属性的Pokemon占总体比例的多少？
#### （b）在所有种族值（Total）不小于580的Pokemon中，非神兽（Legendary=False）的比例为多少？
#### （c）在第一属性为格斗系（Fighting）的Pokemon中，物攻排名前三高的是哪些？
#### （d）请问六项种族指标（HP、物攻、特攻、物防、特防、速度）极差的均值最大的是哪个属性（只考虑第一属性，且均值是对属性而言）？
#### （e）哪个属性（只考虑第一属性）的神兽比例最高？该属性神兽的种族值也是最高的吗？
